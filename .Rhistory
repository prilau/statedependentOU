}
}
}
}
return(node_map[, 1:2])
}
p <- plotStochMaps(tree, maps=stoc_map,
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255")) +
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("output/3_empirical/3b_statedependentBM/augch_map.pdf"), p, width = 9, height = 12)
p <- plotStochMaps(tree, maps=stoc_map,
colors = c("#44AA99",
"#DDCC77",
"#882255")) +
theme(legend.position.inside = c(0.92,0.81))
p
p <- plotStochMaps(tree, maps=stoc_map,
colors = c("0"="#44AA99",
"1"="#DDCC77",
"2"="#882255")) +
theme(legend.position.inside = c(0.92,0.81))
p <- plotStochMaps(tree, maps=stoc_map,
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255")) +
theme(legend.position.inside = c(0.92,0.81))
p
stoc_map
p <- plotStochMaps(tree, maps=stoc_map,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255")) +
theme(legend.position.inside = c(0.92,0.81))
p
stoc_map
stoc_map <- processStochMaps(tree,
simmap = simmaps,
states=c("Herbivore" = "0", "1" = "Omnivore", "2" = "Carnivore"))
stoc_map <- processStochMaps(tree,
simmap = simmaps,
states=c("Herbivore"="0", "Omnivore"="1", "Carnivore"="2"))
stoc_map
stoc_map <- processStochMaps(tree,
simmap = simmaps,
states=c("Herbivore", "Omnivore", "Carnivore"))
stoc_map
stoc_map <- processStochMaps(tree,
simmap = simmaps,
states=c("0", "1", "2"))
colnames(stoc_map)
colnames(stoc_map)[6] = "Herbivore"
colnames(stoc_map)[7] = "Omnivore"
colnames(stoc_map)[8] = "Carnivore"
colnames(stoc_map)
p <- plotStochMaps(tree, maps=stoc_map,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255")) +
theme(legend.position.inside = c(0.92,0.81))
p
ggsave(paste0("output/3_empirical/3b_statedependentBM/augch_map.pdf"), p, width = 9, height = 12)
simmaps <- read.simmap("output/3_empirical/3c_statedependentOU/augch.trees")
simmaps <- read.simmap("output/3_empirical/3c_statedependentOU/augch.trees", format="phylip")
stoc_map <- processStochMaps(tree,
simmap = simmaps,
states=c("0", "1", "2"))
colnames(stoc_map)[6] = "Herbivore"
colnames(stoc_map)[7] = "Omnivore"
colnames(stoc_map)[8] = "Carnivore"
p <- plotStochMaps(tree, maps=stoc_map,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255")) +
theme(legend.position.inside = c(0.92,0.81))
p
ggsave(paste0("output/3_empirical/3c_statedependentOU/augch_map.pdf"), p, width = 9, height = 12)
p <- plotStochMaps(tree, maps=stoc_map,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255"),
tip_labels_size=1) +
theme(legend.position.inside = c(0.92,0.81))
p
p <- plotStochMaps(tree, maps=stoc_map,
line_width=0.25,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255"),
tip_labels_size=1) +
theme(legend.position.inside = c(0.92,0.81))
p
ggsave(paste0("output/3_empirical/3c_statedependentOU/augch_map.pdf"), p, width = 9, height = 12)
p <- plotStochMaps(tree, maps=stoc_map,
tip_labels = FALSE,
line_width=0.25,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255"),
tip_labels_size=1) +
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("output/3_empirical/3c_statedependentOU/augch_map_woTips.pdf"), p, width = 9, height = 12)
p
simmaps <- read.simmap("output/3_empirical/3b_statedependentBM/augch.trees", format="phylip")
colnames(stoc_map)[6] = "Herbivore"
colnames(stoc_map)[7] = "Omnivore"
colnames(stoc_map)[8] = "Carnivore"
p <- plotStochMaps(tree, maps=stoc_map,
tip_labels = FALSE,
line_width=0.25,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255"),
tip_labels_size=1) +
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("output/3_empirical/3b_statedependentBM/augch_map_woTips.pdf"), p, width = 9, height = 12)
ggsave(paste0("output/3_empirical/3b_statedependentBM/augch_map_wTipLabels.pdf"), p, width = 9, height = 12)
p <- plotStochMaps(tree, maps=stoc_map,
tip_labels = TRUE,
line_width=0.25,
color_by = "MAP",
colors = c("Herbivore"="#44AA99",
"Omnivore"="#DDCC77",
"Carnivore"="#882255"),
tip_labels_size=1) +
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("output/3_empirical/3b_statedependentBM/augch_map_wTipLabels.pdf"), p, width = 9, height = 12)
?plotAncStatesMAP
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(1, 3),
tip_states_size = c(0.5, 1.5),
state_transparency = 0.50,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.1
node_color_as = "state",
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.1
node_color_as = "state",
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.1,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(1, 3),
tip_states_size = c(0.5, 1.5),
state_transparency = 0.50,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(1, 3),
tip_states_size = c(0.5, 1.5),
state_transparency = 0.50,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(1, 3),
tip_states_size = c(0.5, 1.5),
state_transparency = 0.60,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(1, 3),
tip_states_size = c(0.5, 1.5),
state_transparency = 0.75,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(1, 5),
tip_states_size = c(0.5, 1.5),
state_transparency = 0.75,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.5, 3),
tip_states_size = node_size,
state_transparency = 0.75,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.5, 3),
tip_states_size = node_size,
state_transparency = 0.75,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.5, 3),
tip_states_size = c(0.5, 3),
state_transparency = 0.75,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_map_MAP.pdf"), p, width = 9, height = 12)
?plotAncStatesPie
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_pie_size = 1
tip_labels_size = 1) +
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_pie_size = 1,
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
state_transparency = 0.80) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_map_Pie.pdf"), p, width = 9, height = 12)
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_MAP_woTipLabel.pdf"), p, width = 9, height = 12)
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_MAP_wTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_Pie_wTipLabels.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
tip_pies = FALSE,
tip_labels_offset = 0.02,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_Pie_wTipLabels.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
tip_pies = FALSE,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_Pie_woTipLabel.pdf"), p, width = 9, height = 12)
ase <- processAncStates("output/3_empirical/3b_statedependentBM/anc_states.tre",
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = c("0" = "Herbivore", "1" = "Omnivore", "2" = "Carnivore"))
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_MAP_woTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
#tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_MAP_wTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
tip_pie_size = 0.25,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_Pie_woTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
tip_pies = FALSE,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_Pie_woTipLabel.pdf"), p, width = 9, height = 12)
?plotAncStatesMAP
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
#tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
tip_states_shape = 15
state_transparency = 0.70,
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
#tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
tip_states_shape = 15,
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_MAP_wTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesMAP(t = ase,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
tip_states_shape = 15,
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_MAP_woTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
tip_pies = FALSE,
tip_labels_offset = 0.02,
#tip_labels = FALSE,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_Pie_wTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesPie(t = ase,
pie_colors = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
tip_labels_size = 1,
tip_pies = FALSE,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
state_transparency = 0.75) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3b_statedependentBM/anc_Pie_woTipLabel.pdf"), p, width = 9, height = 12)
ase <- processAncStates("output/3_empirical/3c_statedependentOU/anc_states.tre",
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = c("0" = "Herbivore", "1" = "Omnivore", "2" = "Carnivore"))
# produce the plot object, showing MAP states at nodes.
# color corresponds to state, size to the state's posterior probability
p <- plotAncStatesMAP(t = ase,
#tip_labels_offset = 0.02,
tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
tip_states_shape = 15,
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_MAP_woTipLabel.pdf"), p, width = 9, height = 12)
p <- plotAncStatesMAP(t = ase,
tip_labels_offset = 0.02,
#tip_labels = FALSE,
node_color_as = "state",
node_color = c("Herbivore"="#44AA99", "Omnivore"="#DDCC77", "Carnivore"="#882255"),
node_size = c(0.1, 4),
tip_states_size = c(0.1, 4),
tip_states_shape = 15,
state_transparency = 0.70,
tree_layout = "rect",
tip_labels_size = 1) +
# modify legend location using ggplot2
theme(legend.position.inside = c(0.92,0.81))
ggsave(paste0("figures/3_empirical/3c_statedependentOU/anc_MAP_wTipLabel.pdf"), p, width = 9, height = 12)
