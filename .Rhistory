2.708050201,
1.722766598,
2.128231706,
1.887069649,
2.602689685,
3.091042453,
2.995732274,
2.48490665,
3.091042453,
1.435084525,
0.587786665,
0.693147181,
0.916290732,
0.576613364,
1.252762968,
1.153731588,
2.63905733,
2.708050201,
2.370243741,
2.890371758,
1.386294361,
0.993251773,
2.890371758,
2.525728644,
1.945910149,
1.945910149,
1.280933845,
2.140066163,
1.504077397,
2.197224577,
2.772588722,
2.460443178,
3.339321978,
1.667706821,
0.993251773,
1.85629799,
1.386294361,
1.609437912,
1.791759469,
2.079441542,
0.916290732,
1.098612289,
1.386294361,
2.014903021,
1.609437912,
2.014903021,
2.595254707,
1.791759469,
2.014903021,
2.302585093,
2.564949357,
2.48490665,
2.48490665,
2.48490665,
2.397895273,
2.564949357,
2.708050201,
2.48490665,
1.547562509,
2.079441542,
1.702928256,
2.079441542,
1.519513205,
1.902107526,
1.675225653,
1.791759469,
1.368639426,
2.014903021,
1.609437912,
2.995732274,
2.708050201,
1.945910149,
3.713572067,
4.248495242,
1.098612289,
1.62924054,
1.098612289,
1.609437912,
1.386294361,
1.214912744,
1.504077397,
1.609437912,
1.386294361,
1.517322624,
1.335001067,
1.609437912,
0.832909123,
1.386294361,
1.60743591,
1.515127233,
1.386294361,
2.63905733,
2.116255515,
3.258096538,
3.258096538,
2.708050201,
3.784189634,
3.218875825,
3.496507561,
2.995732274,
1.740466175,
1.386294361,
1.386294361,
0.587786665,
1.280933845,
1.16315081,
0.431782416,
0.741937345,
1.098612289,
1.131402111,
1.098612289,
0.727548607,
0.875468737,
0.955511445,
0.741937345,
0.482426149,
2.708050201,
2.708050201,
2.785011242,
2.197224577,
2.197224577,
2.116255515,
2.116255515,
1.791759469,
1.515127233,
2.014903021,
1.589235205,
3.044522438,
0.916290732,
3.36729583,
1.62924054,
3.218875825,
2.48490665,
2.63905733,
3.912023005,
2.833213344,
2.128231706,
1.791759469,
1.85629799,
1.704748092,
2.104134154,
1.360976553,
0.936093359,
1.252762968,
1.887069649,
1.252762968,
1.252762968,
1.252762968,
1.166270937,
1.504077397,
0.741937345,
1.609437912,
1.280933845,
1.029619417,
2.890371758,
2.197224577,
2.104134154,
2.708050201,
2.944438979,
2.856470206,
2.104134154,
2.48490665,
4.49980967,
3.295836866,
2.733067964,
1.064710737,
1.791759469,
1.871802177,
2.302585093,
2.302585093,
2.646174797,
2.833213344,
2.890371758,
2.197224577,
2.772588722,
2.890371758,
2.564949357,
1.757857918,
2.302585093,
1.791759469,
1.871802177,
3.401197382,
2.708050201,
1.722766598,
2.079441542,
1.945910149,
1.945910149,
2.753660712,
2.197224577,
2.085672091,
2.079441542,
2.116255515,
1.504077397,
2.63905733,
2.48490665,
2.079441542,
2.48490665,
2.079441542,
1.704748092,
1.871802177,
2.302585093,
2.564949357,
2.397895273,
2.379546134,
1.609437912,
0.955511445,
1.040276712,
1.945910149,
1.481604541,
1.504077397,
1.757857918,
1.360976553,
1.609437912,
2.302585093,
1.85629799,
1.757857918,
2.564949357,
2.014903021,
1.85629799,
2.302585093,
1.147402453,
2.251291799,
0.476234179,
1.85629799,
0.457424847,
1.504077397,
0.916290732,
0.693147181,
0.104360015,
1.504077397,
1.223775432,
0.916290732,
1.740466175,
2.079441542,
3.555348061,
1.633154439,
1.667706821,
2.174751721,
3.295836866,
2.302585093,
0.693147181,
1.470175845,
0.832909123,
1.609437912,
2.63905733,
2.995732274,
1.410986974,
1.386294361,
1.504077397,
2.58021683,
2.197224577,
2.197224577,
3.540959324,
2.995732274,
2.995732274,
2.302585093,
3.411147713,
2.646174797,
3.218875825,
2.748552144,
2.862200881,
2.708050201,
1.945910149,
3.526360525,
2.302585093,
3.80666249,
4.17438727,
4.007333185,
2.985681938,
2.890371758,
2.995732274,
2.833213344,
2.151762203,
2.525728644,
0.693147181,
0.262364264,
1.386294361,
1.098612289,
1.252762968,
1.386294361,
2.890371758,
1.386294361,
3.218875825,
2.944438979,
3.218875825,
1.504077397,
2.646174797,
2.197224577,
2.197224577,
2.302585093,
2.48490665,
1.294727168,
0.916290732,
0.518793793,
1.098612289,
2.079441542,
2.079441542,
2.197224577,
2.397895273,
2.079441542,
1.791759469,
1.791759469,
3.218875825,
2.995732274,
0.647103242,
2.995732274,
3.484312288,
3.091042453,
3.113515309,
2.995732274,
2.63905733,
3.198673118,
1.945910149,
1.720979287,
1.386294361,
1.686398954,
2.442347035,
2.197224577,
2.079441542,
2.48490665,
1.252762968,
2.995732274,
1.791759469,
0.712949808,
1.386294361,
2.525728644,
2.63905733,
2.63905733,
2.564949357,
2.48490665,
2.48490665,
2.116255515,
1.902107526,
1.945910149,
2.833213344,
1.589235205,
2.708050201,
2.302585093,
2.059238834,
2.493205453,
1.214912744,
3.218875825,
2.890371758,
0.916290732,
1.960094784,
2.63905733,
0.916290732,
2.091864062,
2.397895273,
2.079441542,
2.708050201,
2.57261223,
2.564949357,
2.272125886,
1.974081026,
2.010894999,
2.48490665,
1.504077397,
2.302585093,
1.609437912,
1.609437912,
2.890371758,
2.436241478,
2.708050201,
1.791759469,
1.648658626,
1.098612289,
1.658228077,
1.098612289,
1.504077397,
1.111857515,
1.791759469,
1.791759469,
2.48490665,
2.014903021,
1.181727195,
1.871802177,
0.916290732,
1.098612289,
1.609437912,
1.609437912,
1.526056303,
0.470003629,
2.014903021,
2.397895273,
1.646733697,
2.48490665,
2.397895273,
1.791759469,
2.63905733,
2.111424588,
2.397895273,
1.098612289,
1.252762968,
0.78845736,
0.518793793,
1.252762968,
0.741937345,
2.079441542,
1.958685341,
2.116255515,
2.890371758,
2.772588722,
2.302585093,
2.995732274,
2.63905733,
2.890371758,
2.708050201,
2.397895273,
2.140066163,
2.708050201,
1.704748092,
3.39785848
)
var(x)
setwd("Desktop/ASSIM/lab_hoehna/statedependentOU/")
library(RevGadgets)
library(coda)
library(ggplot2)
library(ggtree)
library(grid)
library(gridExtra)
file <- "output/4_empirical_gobiiformes.log"
# read the trace and discard burnin
trace_quant <- readTrace(path = file, burnin = 1/7)
plotTrace(trace = trace_quant, vars = c("halfLife[1]","halfLife[2]","halfLife[3]","halfLife[4]", "halfLife[5]", "halfLife[6]"))[[1]]
library(tid)
library(tidyverse)
?mutate
trace_quant %>% mutate(log_alpha[1] = log(alpha[1]))
trace_quant %>% mutate(log_alpha1 = log(alpha[1]))
type(trace_quant)
class(trace_quant)
trace_quant[1]
trace_quant[1][1]
trace_quant[[1]][1]
trace_quant[[1]][2]
View(trace_quant)
trace_quant[[1]][6]
mutate(trace_quant[[1]][6], log(trace_quant[[1]][6]))
trace_quant[[1]][6] <- mutate(trace_quant[[1]][6], log(trace_quant[[1]][6]))
trace_quant[[1]][7] <- mutate(trace_quant[[1]][7], log(trace_quant[[1]][7]))
trace_quant[[1]][8] <- mutate(trace_quant[[1]][8], log(trace_quant[[1]][8]))
trace_quant[[1]][9] <- mutate(trace_quant[[1]][9], log(trace_quant[[1]][9]))
trace_quant[[1]][10] <- mutate(trace_quant[[1]][10], log(trace_quant[[1]][10]))
trace_quant[[1]][11] <- mutate(trace_quant[[1]][11], log(trace_quant[[1]][11]))
trace_quant[[1]][12] <- mutate(trace_quant[[1]][12], log(trace_quant[[1]][12]))
trace_quant[[1]][13] <- mutate(trace_quant[[1]][13], log(trace_quant[[1]][13]))
trace_quant[[1]][14] <- mutate(trace_quant[[1]][14], log(trace_quant[[1]][14]))
trace_quant[[1]][15] <- mutate(trace_quant[[1]][15], log(trace_quant[[1]][15]))
trace_quant[[1]][16] <- mutate(trace_quant[[1]][16], log(trace_quant[[1]][16]))
trace_quant[[1]][17] <- mutate(trace_quant[[1]][17], log(trace_quant[[1]][17]))
plotTrace(trace = trace_quant, vars = c("halfLife[1]","halfLife[2]","halfLife[3]","halfLife[4]", "halfLife[5]", "halfLife[6]"))[[1]]
plotTrace(trace = trace_quant, vars = c("sigma2[1]","sigma2[2]","sigma2[3]","sigma2[4]", "sigma2[5]", "sigma2[6]"))[[1]]
plotTrace(trace = trace_quant, vars = c("theta[1]","theta[2]","theta[3]","theta[4]", "theta[5]", "theta[6]"))[[1]]
names(trace_quant[[1]][12])
length(trace_quant[[1]])
names(trace_quant[[1]][964])
names(trace_quant[[1]][955])
names(trace_quant[[1]][950])
names(trace_quant[[1]][952])
trace_quant[[1]][952] <- mutate(trace_quant[[1]][952], log(trace_quant[[1]][952]))
trace_quant[[1]][951] <- mutate(trace_quant[[1]][951], log(trace_quant[[1]][951]))
trace_quant[[1]][950] <- mutate(trace_quant[[1]][950], log(trace_quant[[1]][950]))
trace_quant[[1]][949] <- mutate(trace_quant[[1]][949], log(trace_quant[[1]][949]))
trace_quant[[1]][948] <- mutate(trace_quant[[1]][948], log(trace_quant[[1]][948]))
trace_quant[[1]][947] <- mutate(trace_quant[[1]][947], log(trace_quant[[1]][947]))
plotTrace(trace = trace_quant, vars = c("sigma2[1]","sigma2[2]","sigma2[3]","sigma2[4]", "sigma2[5]", "sigma2[6]"))[[1]]
plots <- plotTrace(trace = trace_quant, vars = c("halfLife[1]","halfLife[2]","halfLife[3]","halfLife[4]", "halfLife[5]", "halfLife[6]",
"sigma2[1]","sigma2[2]","sigma2[3]","sigma2[4]", "sigma2[5]", "sigma2[6]",
"theta[1]","theta[2]","theta[3]","theta[4]", "theta[5]", "theta[6]"))[[1]]
library(patchwork)
log_halfLife <- plotTrace(trace = trace_quant, vars = c("halfLife[1]","halfLife[2]","halfLife[3]","halfLife[4]", "halfLife[5]", "halfLife[6]"))[[1]]
log_sigma2 <- plotTrace(trace = trace_quant, vars = c("sigma2[1]","sigma2[2]","sigma2[3]","sigma2[4]", "sigma2[5]", "sigma2[6]"))[[1]]
theta <- plotTrace(trace = trace_quant, vars = c("theta[1]","theta[2]","theta[3]","theta[4]", "theta[5]", "theta[6]"))[[1]]
nested <- (log_halfLife/log_sigma2/theta)+
plot_annotation(tag_levels = 'A') #add figure labels
nested
names(trace_quant[[1]][964])
trace_quant[[1]][964] <- mutate(trace_quant[[1]][964], log(trace_quant[[1]][964]))
trace_quant[[1]][963] <- mutate(trace_quant[[1]][963], log(trace_quant[[1]][963]))
trace_quant[[1]][962] <- mutate(trace_quant[[1]][962], log(trace_quant[[1]][962]))
trace_quant[[1]][961] <- mutate(trace_quant[[1]][961], log(trace_quant[[1]][961]))
trace_quant[[1]][960] <- mutate(trace_quant[[1]][960], log(trace_quant[[1]][960]))
trace_quant[[1]][959] <- mutate(trace_quant[[1]][959], log(trace_quant[[1]][959]))
plotTrace(trace = trace_quant, vars = c("theta[1]","theta[2]","theta[3]","theta[4]", "theta[5]", "theta[6]"))[[1]]
file <- "output/4_empirical_gobiiformes.log"
# read the trace and discard burnin
trace_quant <- readTrace(path = file, burnin = 1/7)
trace_quant[[1]][12] <- mutate(trace_quant[[1]][12], log(trace_quant[[1]][12]))
trace_quant[[1]][13] <- mutate(trace_quant[[1]][13], log(trace_quant[[1]][13]))
trace_quant[[1]][14] <- mutate(trace_quant[[1]][14], log(trace_quant[[1]][14]))
trace_quant[[1]][15] <- mutate(trace_quant[[1]][15], log(trace_quant[[1]][15]))
trace_quant[[1]][16] <- mutate(trace_quant[[1]][16], log(trace_quant[[1]][16]))
trace_quant[[1]][17] <- mutate(trace_quant[[1]][17], log(trace_quant[[1]][17]))
trace_quant[[1]][952] <- mutate(trace_quant[[1]][952], log(trace_quant[[1]][952]))
trace_quant[[1]][951] <- mutate(trace_quant[[1]][951], log(trace_quant[[1]][951]))
trace_quant[[1]][950] <- mutate(trace_quant[[1]][950], log(trace_quant[[1]][950]))
trace_quant[[1]][949] <- mutate(trace_quant[[1]][949], log(trace_quant[[1]][949]))
trace_quant[[1]][948] <- mutate(trace_quant[[1]][948], log(trace_quant[[1]][948]))
trace_quant[[1]][947] <- mutate(trace_quant[[1]][947], log(trace_quant[[1]][947]))
log_halfLife <- plotTrace(trace = trace_quant, vars = c("halfLife[1]","halfLife[2]","halfLife[3]","halfLife[4]", "halfLife[5]", "halfLife[6]"))[[1]]
log_sigma2 <- plotTrace(trace = trace_quant, vars = c("sigma2[1]","sigma2[2]","sigma2[3]","sigma2[4]", "sigma2[5]", "sigma2[6]"))[[1]]
theta <- plotTrace(trace = trace_quant, vars = c("theta[1]","theta[2]","theta[3]","theta[4]", "theta[5]", "theta[6]"))[[1]]
?plotTrace
nested <- (log_halfLife/log_sigma2/theta)+
plot_annotation(tag_levels = 'A') #add figure labels
ggsave("figures/gobiiformes_trace.pdf", nested, width = 200, height = 400, units = "mm")
ggsave("figures/gobiiformes_trace.pdf", nested, width = 300, height = 400, units = "mm")
nested <- ((log_halfLife|log_sigma2)/theta)+
plot_annotation(tag_levels = 'A') #add figure labels
ggsave("figures/gobiiformes_trace.pdf", nested, width = 400, height = 200, units = "mm")
