rnorm(30)
sort(rnorm(15))
plot(rnorm(30))
rnorm(30)
x<-rnorm(30)
plot(x)
hist(x)
x<-rnorm(100)
hist(x)
x1 <- rnorm(1000)
x2 <- rnorm(1000)
hist(x1)
x2 <- rnorm(1000, sd = 3)
hist(x2, add = TRUE)
hist(x2)
hist(x1) + hist(x2)
setwd("Downloads/")
library(ape)
read.nexus("foot_posture_tree.txt")
tree <- read.nexus("foot_posture_tree.txt")
write.tree(tree, "foot_posture.tre")
setwd("~/Desktop/statedependentOU/")
library(RevGadgets)
library(tidyverse)
library(grid)
library(ggplot2)
fp <- tibble(sim = NA,
alpha_12 = 0, alpha_13 = 0, alpha_23 = 0,
halflife_12 = 0, halflife_13 = 0, halflife_23 = 0,
rho_12 = 0, rho_13 = 0, rho_23 = 0,
sigma2_12 = 0, sigma2_13 = 0, sigma2_23 = 0,
stv_12 = 0, stv_13 = 0, stv_23 = 0,
theta_12 = 0, theta_13 = 0, theta_23 = 0)
num_sim = 50
dir_in = "output/2_simulation/sx_logs/"
for (i in 1:num_sim){
file_in <- paste0(dir_in, "sim_", i, "_sx_run_1_2mv_linkedPrior.log")
df <- readTrace(file_in)[[1]] %>%
select(contains("compare"))
fp[i,] = c(i, lapply(df, mean))
}
fp <- fp %>%
pivot_longer(contains("_"), names_to = "par") %>%
group_by(par)
fp_bin <- fp
fp_bin$value <- ifelse(fp$value > 0.975 | fp$value < 0.025, 1, 0)
fp_bin <- fp_bin %>%
group_by(par) %>%
summarise(mean = mean(value))
thresholds <- tibble(sim=1:num_sim, upper=0.975, lower=0.025)
p <- ggplot(fp) +
geom_histogram(aes(x=value), binwidth = 0.05) +
theme_classic() +
geom_vline(mapping = aes(xintercept = lower), data=thresholds, linetype = "dashed", color = "brown") +
geom_vline(mapping = aes(xintercept = upper), data=thresholds, linetype = "dashed", color = "brown") +
ggtitle("False positive rates") +
facet_wrap(facets = vars(par), nrow = 6) +
scale_y_continuous(breaks = c(0, 5, 10))
p
ggplot(fp) +
geom_density(aes(x=value)) +
theme_classic() +
geom_vline(mapping = aes(xintercept = lower), data=thresholds, linetype = "dashed", color = "brown") +
geom_vline(mapping = aes(xintercept = upper), data=thresholds, linetype = "dashed", color = "brown") +
ggtitle("False positive rates") +
facet_wrap(facets = vars(par), nrow = 6) +
scale_y_continuous(breaks = c(0, 5, 10))
p <- ggplot(fp) +
geom_histogram(aes(x=value), binwidth = 0.05) +
theme_classic() +
geom_vline(mapping = aes(xintercept = lower), data=thresholds, linetype = "dashed", color = "brown") +
geom_vline(mapping = aes(xintercept = upper), data=thresholds, linetype = "dashed", color = "brown") +
ggtitle("False positive rates") +
facet_wrap(facets = vars(par), nrow = 6) +
scale_y_continuous(breaks = c(0, 5, 10))
ggsave("figures/2_simulation/triState/fp_hist.pdf", p, width = 200, height = 120, units = "mm")
ggsave("figures/2_simulation/triState/fp_hist.pdf", p, width = 120, height = 200, units = "mm")
fn <- tibble(sim = NA,
alpha_12 = 0, alpha_13 = 0, alpha_23 = 0,
halflife_12 = 0, halflife_13 = 0, halflife_23 = 0,
rho_12 = 0, rho_13 = 0, rho_23 = 0,
sigma2_12 = 0, sigma2_13 = 0, sigma2_23 = 0,
stv_12 = 0, stv_13 = 0, stv_23 = 0,
theta_12 = 0, theta_13 = 0, theta_23 = 0)
fn <- tibble(sim = NA,
alpha_12 = 0, alpha_13 = 0, alpha_23 = 0,
halflife_12 = 0, halflife_13 = 0, halflife_23 = 0,
rho_12 = 0, rho_13 = 0, rho_23 = 0,
sigma2_12 = 0, sigma2_13 = 0, sigma2_23 = 0,
stv_12 = 0, stv_13 = 0, stv_23 = 0,
theta_12 = 0, theta_13 = 0, theta_23 = 0)
num_sim = 50
dir_in = "output/2_simulation/sd_logs/"
for (i in 1:num_sim){
file_in <- paste0(dir_in, "sim_", i, "_sd_run_1_2mv_linkedPrior.log")
df <- readTrace(file_in)[[1]] %>%
select(contains("compare"))
fn[i,] = c(i, lapply(df, mean))
}
par_values <- read.csv2("data/2_simulation/triState/pars.csv/")
par_values <- read.csv2("data/2_simulation/triState/pars.csv")
View(par_values)
pars <- c("theta", "alpha", "sigma2", "rho", "stv", "halflife", sep=",")
par_values <- read.csv2("data/2_simulation/triState/pars.csv", sep=",")
View(par_values)
