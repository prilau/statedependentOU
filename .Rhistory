geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.2) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),shape=factor(halflife), color=factor(halflife)), size=2) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife))) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.2) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),shape=factor(halflife), color=factor(halflife)), size=2) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife))) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.25) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,shape=factor(dtheta_T), color=factor(dtheta_T)), size=2) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T))) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375), linewidth = 0.25)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#########
# plots #
#########
p_th_power <- ggplot(powers_th) +
geom_point(aes(x = halflife, y=power, group=stv, shape=stv, color=stv), size=2) +
geom_line(aes(x = halflife, y=power, group=stv, color=stv)) +
geom_errorbar(aes(x = halflife, ymin = q025_power, ymax=q975_power,
group=stv, color=stv, width=0.0125), linewidth = 0.25)+
scale_shape_manual("V", values=c(15, 16, 17))+
scale_color_manual("V",values=c('#004488', '#DDAA33', '#BB5566')) +
theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.3, 0.6)) +
xlab(TeX("$t_{0.5}$")) +
ylab("") +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Optimum $\\theta$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,shape=factor(dtheta_T), color=factor(dtheta_T)), size=2) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T))) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375), linewidth = 0.25)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),shape=factor(halflife), color=factor(halflife)), size=2) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife))) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.25) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_power <- arrangeGrob(p_hl_power, p_stv_power, p_th_power, nrow = 1)
ggsave("figures/2_simulation/power.pdf", p_power, width = 200, height = 90, unit = "mm")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=2, alpha=0.7) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife))) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.25) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=2, alpha=0.9) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife))) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.25) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,
shape=factor(dtheta_T), color=factor(dtheta_T)),
size=2, alpha=0.9) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T))) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375), linewidth = 0.25)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#########
# plots #
#########
p_th_power <- ggplot(powers_th) +
geom_point(aes(x = halflife, y=power, group=stv, shape=stv, color=stv),
size=2, alpha=0.9) +
geom_line(aes(x = halflife, y=power, group=stv, color=stv)) +
geom_errorbar(aes(x = halflife, ymin = q025_power, ymax=q975_power,
group=stv, color=stv, width=0.0125), linewidth = 0.25)+
scale_shape_manual("V", values=c(15, 16, 17))+
scale_color_manual("V",values=c('#004488', '#DDAA33', '#BB5566')) +
theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.3, 0.6)) +
xlab(TeX("$t_{0.5}$")) +
ylab("") +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Optimum $\\theta$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,
shape=factor(dtheta_T), color=factor(dtheta_T)),
size=2, alpha=0.9) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T))) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375), linewidth = 0.25)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=2, alpha=0.9) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife))) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.25) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_power <- arrangeGrob(p_hl_power, p_stv_power, p_th_power, nrow = 1)
ggsave("figures/2_simulation/power.pdf", p_power, width = 200, height = 90, unit = "mm")
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,
shape=factor(dtheta_T), color=factor(dtheta_T)),
size=2, alpha=0.9) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375), linewidth = 0.25)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=2, alpha=0.9) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2), linewidth = 0.25) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#########
# plots #
#########
p_th_power <- ggplot(powers_th) +
geom_point(aes(x = halflife, y=power, group=stv, shape=stv, color=stv),
size=2, alpha=0.9) +
geom_line(aes(x = halflife, y=power, group=stv, color=stv),
alpha=0.9) +
geom_errorbar(aes(x = halflife, ymin = q025_power, ymax=q975_power,
group=stv, color=stv, width=0.0125), linewidth = 0.25)+
scale_shape_manual("V", values=c(15, 16, 17))+
scale_color_manual("V",values=c('#004488', '#DDAA33', '#BB5566')) +
theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.3, 0.6)) +
xlab(TeX("$t_{0.5}$")) +
ylab("") +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Optimum $\\theta$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#########
# plots #
#########
p_th_power <- ggplot(powers_th) +
geom_point(aes(x = halflife, y=power, group=stv, shape=stv, color=stv),
size=2, alpha=0.9) +
geom_line(aes(x = halflife, y=power, group=stv, color=stv),
alpha=0.9) +
geom_errorbar(aes(x = halflife, ymin = q025_power, ymax=q975_power,
group=stv, color=stv, width=0.0125), linewidth = 0.25,
alpha=0.9)+
scale_shape_manual("V", values=c(15, 16, 17))+
scale_color_manual("V",values=c('#004488', '#DDAA33', '#BB5566')) +
theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.3, 0.6)) +
xlab(TeX("$t_{0.5}$")) +
ylab("") +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Optimum $\\theta$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#########
# plots #
#########
p_th_power <- ggplot(powers_th) +
geom_point(aes(x = halflife, y=power, group=stv, shape=stv, color=stv),
size=2, alpha=0.9) +
geom_line(aes(x = halflife, y=power, group=stv, color=stv),
alpha=0.9) +
geom_errorbar(aes(x = halflife, ymin = q025_power, ymax=q975_power,
group=stv, color=stv, width=0.0125),
linewidth = 0.25, alpha=0.9)+
scale_shape_manual("V", values=c(15, 16, 17))+
scale_color_manual("V",values=c('#004488', '#DDAA33', '#BB5566')) +
theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.3, 0.6)) +
xlab(TeX("$t_{0.5}$")) +
ylab("") +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Optimum $\\theta$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,
shape=factor(dtheta_T), color=factor(dtheta_T)),
size=2, alpha=0.9) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375),
linewidth = 0.25, alpha=0.9)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=2, alpha=0.9) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2),
linewidth = 0.25, alpha=0.9) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_power <- arrangeGrob(p_hl_power, p_stv_power, p_th_power, nrow = 1)
ggsave("figures/2_simulation/power.pdf", p_power, width = 200, height = 90, unit = "mm")
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,
shape=factor(dtheta_T), color=factor(dtheta_T)),
size=1.5, alpha=0.9) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375),
linewidth = 0.25, alpha=0.9)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_hl_power
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=1.5, alpha=0.9) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2),
linewidth = 0.25, alpha=0.9) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
#########
# plots #
#########
p_th_power <- ggplot(powers_th) +
geom_point(aes(x = halflife, y=power, group=stv, shape=stv, color=stv),
size=1.5, alpha=0.9) +
geom_line(aes(x = halflife, y=power, group=stv, color=stv),
alpha=0.9) +
geom_errorbar(aes(x = halflife, ymin = q025_power, ymax=q975_power,
group=stv, color=stv, width=0.0125),
linewidth = 0.25, alpha=0.9)+
scale_shape_manual("V", values=c(15, 16, 17))+
scale_color_manual("V",values=c('#004488', '#DDAA33', '#BB5566')) +
theme_bw() +
scale_x_continuous(breaks=c(0.1, 0.3, 0.6)) +
xlab(TeX("$t_{0.5}$")) +
ylab("") +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Optimum $\\theta$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_hl_power <- ggplot(powers_hl) +
geom_point(aes(x = stv, y=power, group=stv,
shape=factor(dtheta_T), color=factor(dtheta_T)),
size=1.5, alpha=0.9) +
geom_line(aes(x = stv, y=power, group=factor(dtheta_T), color=factor(dtheta_T)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$\\Delta \\theta$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$\\Delta \\theta$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = stv, ymin = q025_power, ymax=q975_power,
group=factor(dtheta_T), color=factor(dtheta_T), width=0.0375),
linewidth = 0.25, alpha=0.9)+
ylab("Power") +
xlab("V") +
scale_x_continuous(breaks=c(0.5, 1, 2), label=c("0.5v", "v", "2v")) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle(TeX("Phylogenetic half-life $t_{0.5}$")) +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power <- ggplot(powers_stv) +
geom_point(aes(x = dtheta_T, y=power, group=factor(halflife),
shape=factor(halflife), color=factor(halflife)),
size=1.5, alpha=0.9) +
geom_line(aes(x = dtheta_T, y=power, group=factor(halflife), color=factor(halflife)),
alpha=0.9) +
theme_bw() +
scale_shape_manual(TeX("$t_{0.5}$"), values=c(15, 16, 17)) +
scale_color_manual(TeX("$t_{0.5}$"), values=c('#004488', '#DDAA33', '#BB5566')) +
geom_errorbar(aes(x = dtheta_T, ymin = q025_power, ymax=q975_power,
group=halflife, color=factor(halflife), width=0.2),
linewidth = 0.25, alpha=0.9) +
ylab("") +
xlab(TeX("$\\Delta \\theta$")) +
scale_x_continuous(breaks=c(2, 6, 10)) +
coord_cartesian(ylim=c(0, 1)) +
ggtitle("Stationary variance V") +
theme(plot.title = element_text(hjust = 0.5),
legend.position = "bottom")
p_stv_power
p_power <- arrangeGrob(p_hl_power, p_stv_power, p_th_power, nrow = 1)
ggsave("figures/2_simulation/power.pdf", p_power, width = 200, height = 90, unit = "mm")
library(cowplot)
?plot_grid
fp <- read.csv("output/2_simulation/false_positive/grid.csv")
thresholds <- tibble(sim=1:num_sim, upper=0.975, lower=0.025)
p <- list()
pars <- c("halflife", "stv", "theta")
pars_title <- c(TeX("Phylogenetic half-life $t_{0.5}$"), "Stationary variance V", TeX("Optimum $\\theta$"))
pars_ylab <- c(TeX("P($t_{0.5_1} > t_{0.5_2}$)"), TeX("P($V_1 > V_2$)"), TeX("P($\\theta_1 > \\theta_2$)"))
i=1
for (par in pars){
fp_par <- fp %>%
pivot_longer(contains(par), names_to = "par")
p[[par]] <- ggplot(fp_par) +
geom_histogram(aes(x=value), binwidth = 0.05) +
theme_classic() +
geom_vline(mapping = aes(xintercept = lower), data=thresholds, linetype = "dashed", color = "brown") +
geom_vline(mapping = aes(xintercept = upper), data=thresholds, linetype = "dashed", color = "brown") +
ggtitle(pars_title[i]) +
scale_y_continuous(breaks=c(0, 30, 60, 90)) +
coord_cartesian(ylim=c(0, 105)) +
xlab(pars_ylab[i]) +
ylab("") +
#scale_y_continuous(breaks = c(0, 20, 40)) +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_blank())
i=i+1
}
num_sim = 1000
thresholds <- tibble(sim=1:num_sim, upper=0.975, lower=0.025)
for (par in pars){
fp_par <- fp %>%
pivot_longer(contains(par), names_to = "par")
p[[par]] <- ggplot(fp_par) +
geom_histogram(aes(x=value), binwidth = 0.05) +
theme_classic() +
geom_vline(mapping = aes(xintercept = lower), data=thresholds, linetype = "dashed", color = "brown") +
geom_vline(mapping = aes(xintercept = upper), data=thresholds, linetype = "dashed", color = "brown") +
ggtitle(pars_title[i]) +
scale_y_continuous(breaks=c(0, 30, 60, 90)) +
coord_cartesian(ylim=c(0, 105)) +
xlab(pars_ylab[i]) +
ylab("") +
#scale_y_continuous(breaks = c(0, 20, 40)) +
theme(plot.title = element_text(hjust = 0.5),
axis.title.y = element_blank())
i=i+1
}
# plot table
fp_bin <- fp %>%
pivot_longer(!c("sim"), names_to = "par") %>%
filter(par %in% c("halflife", "stv", "theta")) %>%
mutate(value = ifelse(value > 0.975 | value < 0.025, 1, 0)) %>%
group_by(par) %>%
summarise(`False positive rate` = signif(mean(value),2)) %>%
rename(Parameter = par)
fp_bin
